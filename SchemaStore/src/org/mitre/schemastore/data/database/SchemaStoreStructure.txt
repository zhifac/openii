//-----------------
// Generate Tables
//-----------------

CREATE TABLE alias (
	id integer NOT NULL,
	element_id integer,
	name character varying(50));

CREATE TABLE annotation (
	object_id integer,
	attribute character varying(50),
	value character varying(200));

CREATE TABLE attribute (
	id integer NOT NULL,
	name character varying(50) NOT NULL,
	description character varying(200),
	entity_id integer,
	domain_id integer,
	"min" integer,
	"max" integer);

CREATE TABLE containment (
	id integer NOT NULL,
	parent_id integer NOT NULL,
	child_id integer NOT NULL,
    "min" integer,
    "max" integer,
    description character varying(200),
    name character varying(50)
);

CREATE TABLE data_source (
    id integer NOT NULL,
    name character varying(50),
    url character varying(200),
    schema_id integer
);

CREATE TABLE "domain" (
    id integer NOT NULL,
    name character varying(50) NOT NULL,
    description character varying(200)
);

CREATE TABLE domainvalue (
    id integer NOT NULL,
    value character varying(50),
    description character varying(200),
    domain_id integer
);

CREATE TABLE entity (
    id integer NOT NULL,
    name character varying(50) NOT NULL,
    description character varying(200)
);

CREATE TABLE extensions (
    schema_id integer NOT NULL,
    "action" character varying(20),
    element_id integer NOT NULL
);

CREATE TABLE groups (
    id integer NOT NULL,
    name character varying(50) NOT NULL,
    parent_id integer
);

CREATE TABLE mapping (
    id integer NOT NULL,
    author character varying(50),
    description character varying(200),
    name character varying(50)
);

CREATE TABLE mapping_cell (
    id integer NOT NULL,
    mapping_id integer,
    element1_id integer,
    element2_id integer,
    score numeric,
    scorer character varying(50),
    validated character
);

CREATE TABLE mapping_schema (
    mapping_id integer NOT NULL,
    schema_id integer NOT NULL
);

CREATE TABLE relationship (
    id integer NOT NULL,
    name character varying(50) NOT NULL,
    left_id integer NOT NULL,
    left_min integer,
    left_max integer,
    right_id integer NOT NULL,
    right_min integer,
    right_max integer
);

CREATE TABLE "schema" (
    id integer NOT NULL,
    name character varying(50) NOT NULL,
    author character varying(50) NOT NULL,
    source character varying(200) NOT NULL,
    "type" character varying(50) NOT NULL,
    description character varying(200),
    locked character NOT NULL
);

CREATE TABLE schema_element (
    id integer NOT NULL,
    "type" character varying(50)
);

CREATE TABLE schema_group (
    group_id integer NOT NULL,
    schema_id integer NOT NULL
);

CREATE TABLE subtype (
    id integer,
    parent_id integer,
    child_id integer
);

//-----------------------
// Generate Primary Keys
//-----------------------

ALTER TABLE alias
    ADD CONSTRAINT alias_pkey PRIMARY KEY (id);

ALTER TABLE attribute
    ADD CONSTRAINT attribute_pkey PRIMARY KEY (id);

ALTER TABLE containment
    ADD CONSTRAINT containment_pkey PRIMARY KEY (id);

ALTER TABLE "domain"
    ADD CONSTRAINT domain_pkey PRIMARY KEY (id);

ALTER TABLE domainvalue
    ADD CONSTRAINT domainvalue_pkey PRIMARY KEY (id);

ALTER TABLE entity
    ADD CONSTRAINT entity_pkey PRIMARY KEY (id);

ALTER TABLE groups
    ADD CONSTRAINT groups_pkey PRIMARY KEY (id);

ALTER TABLE data_source
    ADD CONSTRAINT instance_pkey PRIMARY KEY (id);

ALTER TABLE mapping_cell
    ADD CONSTRAINT mapping_cell_pkey PRIMARY KEY (id);

ALTER TABLE mapping
    ADD CONSTRAINT mapping_pkey PRIMARY KEY (id);

ALTER TABLE relationship
    ADD CONSTRAINT relationship_pkey PRIMARY KEY (id);

ALTER TABLE schema_element
    ADD CONSTRAINT schema_element_pkey PRIMARY KEY (id);

ALTER TABLE "schema"
    ADD CONSTRAINT schema_pkey PRIMARY KEY (id);

//-----------------------
// Generate Foreign Keys
//-----------------------

ALTER TABLE domainvalue
    ADD CONSTRAINT domainvalue_domain_fkey FOREIGN KEY (domain_id) REFERENCES "domain"(id);

ALTER TABLE attribute
    ADD CONSTRAINT attribute_entity_fkey FOREIGN KEY (entity_id) REFERENCES entity(id);

ALTER TABLE relationship
    ADD CONSTRAINT relationship_leftentity_fkey FOREIGN KEY (left_id) REFERENCES entity(id);

ALTER TABLE extensions
    ADD CONSTRAINT extensions_schema_fkey FOREIGN KEY (schema_id) REFERENCES "schema"(id);

ALTER TABLE data_source
    ADD CONSTRAINT datasource_schema_fkey FOREIGN KEY (schema_id) REFERENCES "schema"(id);

ALTER TABLE groups
    ADD CONSTRAINT groups_groups_fkey FOREIGN KEY (parent_id) REFERENCES groups(id);

ALTER TABLE schema_group
    ADD CONSTRAINT schemagroup_groups_fkey FOREIGN KEY (group_id) REFERENCES groups(id);

ALTER TABLE attribute
    ADD CONSTRAINT attribute_domain_fkey FOREIGN KEY (domain_id) REFERENCES "domain"(id);

ALTER TABLE relationship
    ADD CONSTRAINT relationship_rightentity_fkey FOREIGN KEY (right_id) REFERENCES entity(id);

ALTER TABLE schema_group
    ADD CONSTRAINT schemagroup_schema_fkey FOREIGN KEY (schema_id) REFERENCES "schema"(id);

ALTER TABLE mapping_cell
    ADD CONSTRAINT mappingcell_mapping_id_fkey FOREIGN KEY (mapping_id) REFERENCES mapping(id);

ALTER TABLE mapping_schema
    ADD CONSTRAINT mappingschema_mapping_fkey FOREIGN KEY (mapping_id) REFERENCES mapping(id);

ALTER TABLE mapping_schema
    ADD CONSTRAINT mappingschema_schema_fkey FOREIGN KEY (schema_id) REFERENCES "schema"(id);

//------------------
// Generate Indexes
//------------------

CREATE UNIQUE INDEX schema_group_idx ON schema_group (schema_id, group_id);

//-------------------
// Generate Sequence
//-------------------

CREATE SEQUENCE universalseq
	START WITH 1000
    INCREMENT BY 1
    NO MAXVALUE
    NO MINVALUE
    CACHE 1;